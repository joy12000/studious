const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/safeCreateNote-BTgOMee0.js","assets/vendor-CmA5HJss.js","assets/db-Y9c9-XV0.js","assets/router-XfUN8hxR.js","assets/icons-DV3YslgN.js"])))=>i.map(i=>d[i]);
var Be=Object.defineProperty,_e=Object.defineProperties;var Me=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var _=(t,s,r)=>s in t?Be(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,S=(t,s)=>{for(var r in s||(s={}))Z.call(s,r)&&_(t,r,s[r]);if(I)for(var r of I(s))ee.call(s,r)&&_(t,r,s[r]);return t},T=(t,s)=>_e(t,Me(s));var te=t=>typeof t=="symbol"?t:t+"",se=(t,s)=>{var r={};for(var a in t)Z.call(t,a)&&s.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&I)for(var a of I(t))s.indexOf(a)<0&&ee.call(t,a)&&(r[a]=t[a]);return r};var F=(t,s,r)=>_(t,typeof s!="symbol"?s+"":s,r);var w=(t,s,r)=>new Promise((a,o)=>{var n=f=>{try{d(r.next(f))}catch(c){o(c)}},l=f=>{try{d(r.throw(f))}catch(c){o(c)}},d=f=>f.done?a(f.value):Promise.resolve(f.value).then(n,l);d((r=r.apply(t,s)).next())});import{r as m,a as Je,R as we}from"./vendor-CmA5HJss.js";import{D as Ke}from"./db-Y9c9-XV0.js";import{L as D,u as Ve,a as je,b as He,B as We,R as qe,c as O}from"./router-XfUN8hxR.js";import{S as ve,a as ze,P as Ne,b as Ge,c as Ye,C as Qe,A as ke,d as Xe,H as re,T as U,e as Ze,E as et,X as Se,f as H,L as tt,D as st,U as rt,I as nt,g as at,R as Ce,h as ot,F as it,i as lt,j as ct,M as dt,k as ut,l as xt,m as ht}from"./icons-DV3YslgN.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();var Ee={exports:{}},B={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mt=m,ft=Symbol.for("react.element"),gt=Symbol.for("react.fragment"),pt=Object.prototype.hasOwnProperty,bt=mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yt={key:!0,ref:!0,__self:!0,__source:!0};function Te(t,s,r){var a,o={},n=null,l=null;r!==void 0&&(n=""+r),s.key!==void 0&&(n=""+s.key),s.ref!==void 0&&(l=s.ref);for(a in s)pt.call(s,a)&&!yt.hasOwnProperty(a)&&(o[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)o[a]===void 0&&(o[a]=s[a]);return{$$typeof:ft,type:t,key:n,ref:l,props:o,_owner:bt.current}}B.Fragment=gt;B.jsx=Te;B.jsxs=Te;Ee.exports=B;var e=Ee.exports,W={},ne=Je;W.createRoot=ne.createRoot,W.hydrateRoot=ne.hydrateRoot;class wt extends we.Component{constructor(r){super(r);F(this,"hardReload",()=>{var r;try{(r=navigator.serviceWorker)!=null&&r.controller&&navigator.serviceWorker.getRegistrations().then(a=>a.forEach(o=>o.update()))}catch(a){}location.reload()});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("[ErrorBoundary]",r,a)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow border border-gray-100 p-5 space-y-3",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"앗! 화면에 문제가 생겼어요."}),e.jsx("p",{className:"text-sm text-gray-600",children:"새로고침하면 대부분 해결됩니다. 계속되면 캐시를 갱신해요."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:this.hardReload,className:"px-3 py-2 text-sm rounded bg-blue-600 text-white",children:"새로고침"}),e.jsx("button",{onClick:()=>this.setState({hasError:!1,error:void 0}),className:"px-3 py-2 text-sm rounded bg-gray-100",children:"무시하고 계속"})]}),this.state.error&&e.jsx("pre",{className:"text-xs text-red-600 bg-red-50 rounded p-2 overflow-auto",children:String(this.state.error)})]})}):this.props.children}}class jt extends Ke{constructor(){super("selfdev-db");F(this,"notes");F(this,"settings");this.version(1).stores({notes:"id, createdAt, *topics, favorite, sourceType",settings:"id"}),this.on("ready",()=>w(this,null,function*(){(yield this.settings.count())===0&&(yield this.settings.add({id:"default",topicRules:{Productivity:["습관","루틴","집중","시간","우선순위","체크리스트","할 일","타임블록","계획","관리"],Learning:["학습","공부","기억","복습","필기","메타인지","요약","독서","지식","스킬"],Mindset:["마인드","동기","자존감","감정","회복탄력성","성장","사고","긍정","마음가짐"],Health:["수면","식단","건강","스트레스","휴식","웰빙","몸","컨디션"],Fitness:["운동","웨이트","러닝","유산소","근력","체력","트레이닝","다이어트"],Finance:["투자","저축","지출","예산","수입","재무","파이낸스","돈","경제"],Career:["경력","업무","리더십","협업","면접","이력서","보고","직장","커리어"],Tech:["코드","프로그래밍","개발","AI","알고리즘","데이터","기술","디지털"],Relationships:["소통","관계","공감","피드백","갈등","인간관계","네트워킹"],Creativity:["아이디어","글쓰기","디자인","브레인스토밍","창의","예술","상상력"]},theme:"light",defaultTopics:["Productivity","Learning","Mindset","Health","Finance","Career","Tech","Relationships","Fitness","Creativity","Other"]}))}))}}const k=new jt,vt={Productivity:["습관","루틴","집중","시간","우선순위","체크리스트","할 일","타임블록","계획","관리","todo","task","schedule","deadline","회의","미팅"],Learning:["학습","공부","기억","복습","필기","메타인지","요약","독서","지식","스킬","강의","수업","세미나","스터디","lecture","course","study"],Mindset:["마인드","동기","자존감","감정","회복탄력성","성장","사고","긍정","마음가짐","멘탈","동기부여","인내"],Health:["수면","식단","건강","스트레스","휴식","웰빙","몸","컨디션","영양","정신건강","병원"],Fitness:["운동","웨이트","러닝","유산소","근력","체력","트레이닝","다이어트","헬스","요가","필라테스","run","workout","gym"],Finance:["투자","저축","지출","예산","수입","재무","파이낸스","돈","경제","청구","결제","부채","세금","금리","ETF","주식"],Career:["경력","업무","리더십","협업","면접","이력서","보고","직장","커리어","성과","OKR","승진","목표","feedback"],Tech:["코드","프로그래밍","개발","AI","알고리즘","데이터","기술","디지털","서버","배포","리팩터링","버그","테스트","API","프론트","백엔드"],Relationships:["소통","관계","공감","피드백","갈등","인간관계","네트워킹","팀워크","회의문화","커뮤니케이션"],Creativity:["아이디어","글쓰기","디자인","브레인스토밍","창의","예술","상상력","스케치","콘셉트","카피","콘텐츠"],Travel:["여행","항공","호텔","예약","여권","비행기","투어","여정","일정표","관광","바캉스","휴양지"],Legal:["법률","계약","약관","분쟁","저작권","라이선스","위험조항","소송","준법","컴플라이언스"],Tax:["세무","세금","부가세","원천징수","신고","환급","공제","납부","영수증","세법"],Marketing:["마케팅","브랜딩","캠페인","광고","콘텐츠","SNS","SEO","퍼포먼스","CRM","리텐션","전환","랜딩"],Sales:["영업","견적","구매","고객","리드","계약서","가격","딜","세일즈파이프라인","MQL","SQL","콜"],Education:["교육","커리큘럼","과제","시험","평가","강의안","학습계획","MOOC"],Project:["프로젝트","기획","요구사항","타임라인","마일스톤","칸반","이슈","티켓","스코프","리소스"],Research:["연구","실험","논문","데이터셋","가설","분석","리뷰","재현성","실험계획"],Personal:["일기","회고","목표","감사일기","버킷리스트","취미","생활"]};function q(t){return w(this,null,function*(){var s;try{const r=yield k.settings.get("default"),a=S(S({},vt),(r==null?void 0:r.topicRules)||{}),o=t.toLowerCase(),n={};for(const[u,p]of Object.entries(a))n[u]=p.reduce((y,g)=>y+(o.includes(g.toLowerCase())?1:0),0);const l=new Set;(t.match(/(^|\s)#([\p{L}\p{N}_-]{2,30})/gu)||[]).forEach(u=>{const p=u.replace(/^\s*#/,"").trim();p&&l.add(p)});const d=Object.entries(n).filter(([,u])=>u>0).sort((u,p)=>p[1]-u[1]).slice(0,5).map(([u])=>u),f=Array.from(l).slice(0,5),c=[...new Set([...f,...d])];return c.length?c:((s=r==null?void 0:r.defaultTopics)==null?void 0:s.slice(0,1))||["Other"]}catch(r){return console.error("guessTopics error",r),["Other"]}})}function Ae(t){const s=t.trim(),r=s.split(`
`).find(u=>u.trim().length>0)||"";if(r.length<=50)return r;const o=s.toLowerCase().replace(/[^\p{L}\p{N}\s]/gu," ").split(/\s+/).filter(Boolean),n=new Set(["the","is","are","a","an","to","of","and","or","for","in","on","at","it","this","that","은","는","이","가","을","를","에","와","과","로","으로","하다","했다","합니다"]),l={};for(const u of o)n.has(u)||(l[u]=(l[u]||0)+1);const d=Object.entries(l).sort((u,p)=>p[1]-u[1]).slice(0,3).map(([u])=>u),f=u=>u.charAt(0).toUpperCase()+u.slice(1),c=d.map(f).join(" · ")||r;return c.length<=80?c:c.slice(0,79)+"…"}function z(){var g;const[t,s]=m.useState([]),[r,a]=m.useState(!0),[o,n]=m.useState({search:""}),l=m.useMemo(()=>{var x,i,h;return JSON.stringify({search:(x=o.search)!=null?x:"",topics:(i=o.topics)!=null?i:[],favorite:!!o.favorite,dateRange:(h=o.dateRange)!=null?h:"all"})},[o.search,JSON.stringify((g=o.topics)!=null?g:[]),o.favorite,o.dateRange]),d=()=>w(this,null,function*(){var h;a(!0);let x=yield k.notes.toArray();x=(x||[]).map(b=>S({labels:[],highlights:[],todo:[],favorite:!1,sourceType:"other"},b));const i=((h=o.search)!=null?h:"").trim().toLowerCase();if(i&&(x=x.filter(b=>(b.title||"").toLowerCase().includes(i)||(b.content||"").toLowerCase().includes(i))),o.topics&&o.topics.length&&(x=x.filter(b=>(b.topics||[]).some(j=>o.topics.includes(j)))),o.favorite&&(x=x.filter(b=>!!b.favorite)),o.dateRange&&o.dateRange!=="all"){const b=Date.now(),j=o.dateRange==="today"?b-24*60*60*1e3:o.dateRange==="7days"?b-7*24*60*60*1e3:b-30*24*60*60*1e3;x=x.filter(N=>{var C;return((C=N.createdAt)!=null?C:0)>=j})}x.sort((b,j)=>{var N,C;return((N=j.createdAt)!=null?N:0)-((C=b.createdAt)!=null?C:0)}),s(x),a(!1)});m.useEffect(()=>{d()},[l]);const f=x=>w(this,null,function*(){const i=yield k.notes.get(x);i&&(yield k.notes.update(x,{favorite:!i.favorite,updatedAt:Date.now()}),yield d())}),c=(x,i)=>w(this,null,function*(){var Y,Q,X;let h="",b=null,j="other",N;if(typeof x=="string"?(h=(x!=null?x:"").trim(),b=i!=null?i:null):x&&typeof x=="object"&&(h=((Y=x.content)!=null?Y:"").trim(),N=((Q=x.title)!=null?Q:"").trim()||void 0,b=(X=x.sourceUrl)!=null&&X?String(x.sourceUrl).trim():null,x.sourceType==="youtube"||x.sourceType==="web"||x.sourceType==="other"?j=x.sourceType:b&&(j=b.includes("youtube.com")||b.includes("youtu.be")?"youtube":"web")),!h)throw new Error("내용이 비어 있음");const C=crypto.randomUUID(),v=N||(yield Ae(h)),E=yield q(h),G=Date.now(),Ue={id:C,title:v,content:h,sourceUrl:b,sourceType:j,createdAt:G,updatedAt:G,topics:E,labels:[],highlights:[],todo:[],favorite:!1};return yield k.notes.add(Ue),yield d(),C}),u=(x,i)=>w(this,null,function*(){yield k.notes.update(x,T(S({},i),{updatedAt:Date.now()})),yield d()}),p=x=>w(this,null,function*(){yield k.notes.delete(x),yield d()});function y(x){var b,j,N,C,v,E;const i=o;((b=i.search)!=null?b:"")===((j=x.search)!=null?j:"")&&JSON.stringify((N=i.topics)!=null?N:[])===JSON.stringify((C=x.topics)!=null?C:[])&&!!i.favorite==!!x.favorite&&((v=i.dateRange)!=null?v:"all")===((E=x.dateRange)!=null?E:"all")||n(x)}return{notes:t,loading:r,filters:o,setFilters:y,toggleFavorite:f,addNote:c,updateNote:u,deleteNote:p}}function Nt({note:t,onToggleFavorite:s}){const r=a=>{if(a&&a.stopPropagation(),!t.sourceUrl)return;const o=t.sourceUrl,n=o.match(/(?:v=|youtu\.be\/)([A-Za-z0-9_-]{6,})/i),l=n?n[1]:null,d=l?`vnd.youtube://watch?v=${l}`:o,f=()=>window.open(o,"_blank");let c=!1;const u=setTimeout(()=>{c||f()},350);try{window.location.href=d,c=!0}catch(p){}setTimeout(()=>clearTimeout(u),2e3)};return e.jsxs(D,{to:`/note/${t.id}`,className:"block bg-white rounded-2xl p-6 shadow-md hover:shadow-xl transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-lg text-gray-900",children:t.title||"제목 없음"}),e.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap mt-2 line-clamp-3",children:t.content}),t.sourceUrl&&e.jsx("button",{onClick:r,className:"text-teal-600 hover:text-teal-700 text-sm font-medium mt-4",title:"원본 열기",children:"원본 열기"})]}),s&&e.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),s(t.id)},className:"text-gray-300 hover:text-yellow-400 transition-colors",title:t.favorite?"즐겨찾기 해제":"즐겨찾기",children:e.jsx(ve,{className:`w-6 h-6 ${t.favorite?"fill-yellow-400 text-yellow-400":""}`})})]}),Array.isArray(t.topics)&&t.topics.length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:t.topics.map(a=>e.jsx("div",{className:"bg-gray-100 text-gray-600 rounded-full px-3 py-1 text-xs font-medium",children:a},a))})]})}function kt({filters:t,onFiltersChange:s,availableTopics:r=[]}){var p,y;const[a,o]=m.useState((p=t==null?void 0:t.search)!=null?p:""),[n,l]=m.useState((y=t==null?void 0:t.topics)!=null?y:[]),[d,f]=m.useState(!1),c=m.useRef(null);m.useEffect(()=>(c.current&&window.clearTimeout(c.current),c.current=window.setTimeout(()=>{s(T(S({},t||{}),{search:a||void 0,topics:n.length?n:void 0}))},200),()=>{c.current&&window.clearTimeout(c.current)}),[a,n]);const u=g=>{l(x=>x.includes(g)?x.filter(i=>i!==g):[...x,g])};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-gray-500/20 pb-3",children:[e.jsx(ze,{className:"h-5 w-5 text-gray-500"}),e.jsx("input",{value:a,onChange:g=>o(g.target.value),onCompositionStart:()=>f(!0),onCompositionEnd:()=>f(!1),placeholder:"노트 검색...",className:"flex-1 outline-none bg-transparent text-base placeholder-gray-500"})]}),r.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:r.map(g=>e.jsx("button",{onClick:()=>u(g),className:`text-xs px-3 py-1 rounded-full border transition-colors ${n.includes(g)?"bg-teal-600 text-white border-teal-600":"bg-white/60 text-gray-800 border-gray-200/80 hover:bg-white/90"}`,children:g},g))})]})}function St({value:t,onChange:s}){const r=[{key:"today",label:"오늘"},{key:"7days",label:"7일"},{key:"30days",label:"30일"},{key:"all",label:"전체"}];return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(Qe,{className:"h-4 w-4 text-gray-400"}),r.map(a=>e.jsx("button",{onClick:()=>s(a.key),className:`px-2 py-1 rounded-full border ${t===a.key?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:a.label},a.key))]})}function Ct(){var p;const{notes:t,loading:s,filters:r,setFilters:a,toggleFavorite:o}=z(),[n,l]=m.useState([]),[d,f]=m.useState(()=>{try{return localStorage.getItem("pinFavorites")!=="false"}catch(y){return!0}});m.useEffect(()=>{const y=new Set;t.forEach(g=>(g.topics||[]).forEach(x=>y.add(x))),l(Array.from(y).sort())},[t]),m.useEffect(()=>{try{localStorage.setItem("pinFavorites",String(d))}catch(y){}},[d]);const c=m.useMemo(()=>{const y=[...t];if(y.sort((i,h)=>{var b,j;return((b=h==null?void 0:h.createdAt)!=null?b:0)-((j=i==null?void 0:i.createdAt)!=null?j:0)}),!d)return y;const g=y.filter(i=>!!i.favorite),x=y.filter(i=>!i.favorite);return[...g,...x]},[t,d]),u=y=>{a(T(S({},r||{}),{dateRange:y}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"SelfDev Notes"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"자기계발 요약 & 기록"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{to:"/capture",className:"inline-flex items-center gap-2 text-sm px-4 py-2 rounded-lg bg-teal-600 text-white shadow-sm hover:bg-teal-700 transition-colors",children:[e.jsx(Ne,{className:"h-4 w-4"})," 새 노트"]}),e.jsxs(D,{to:"/settings",className:"inline-flex items-center gap-2 text-sm px-4 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-100 text-gray-700 transition-colors",children:[e.jsx(Ge,{className:"h-4 w-4"})," 설정"]})]})]}),e.jsxs("div",{className:"bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 p-4 space-y-4",children:[e.jsx(kt,{filters:r,onFiltersChange:a,availableTopics:n}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(St,{value:(p=r==null?void 0:r.dateRange)!=null?p:"all",onChange:u}),e.jsxs("button",{onClick:()=>f(y=>!y),className:`inline-flex items-center gap-1 text-xs px-2 py-1 rounded-full border transition-colors ${d?"bg-teal-100 border-teal-200 text-teal-800":"bg-white/70 border-gray-200 text-gray-600 hover:bg-gray-50"}`,title:"즐겨찾기 상단 고정",children:[e.jsx(Ye,{className:"h-3 w-3"})," 즐겨찾기 우선: ",d?"ON":"OFF"]})]})]}),s&&e.jsx("div",{className:"text-center text-gray-500 py-20",children:"불러오는 중…"}),!s&&c.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-20",children:"노트가 없습니다. 오른쪽 상단의 “새 노트”를 눌러 추가해보세요."}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:c.map(y=>e.jsx(Nt,{note:y,onToggleFavorite:o},y.id))})]})}const Re="userTemplates";function Et(){const t=new Date,s=r=>r.toString().padStart(2,"0");return`${t.getFullYear()}-${s(t.getMonth()+1)}-${s(t.getDate())}`}function ae(t){return t.replace(/\{\{date\}\}/g,Et()).replace(/\{\{time\}\}/g,new Date().toLocaleTimeString())}function Tt(){try{const t=localStorage.getItem(Re);if(!t)return[];const s=JSON.parse(t);if(Array.isArray(s))return s}catch(t){}return[]}function oe(t){try{localStorage.setItem(Re,JSON.stringify(t))}catch(s){}}const ie=[{id:"default-meeting",name:"회의 메모",content:`# 회의 메모 — {{date}}

## 안건
- 

## 핵심 결론
- 

## 할 일(To-Do)
- [ ] 담당자:  / 마감: 

## 참고
- 
`},{id:"default-reading",name:"독서 노트",content:`# 독서 노트 — {{date}}

## 책/출처
- 

## 인상 깊은 문장
> 

## 요약
- 

## 적용 아이디어
- 
`},{id:"default-idea",name:"아이디어 스케치",content:`# 아이디어 — {{date}}

## 한 줄
- 

## 문제/고객
- 

## 해결 아이디어
- 

## 다음 실험
- 가설: 
- 지표: 
- 마감: 
`}];function At({onInsert:t}){const[s,r]=m.useState(Tt()),[a,o]=m.useState(!1),[n,l]=m.useState(null);m.useMemo(()=>[...ie,...s],[s]);function d(c){r(u=>{const p=u.some(y=>y.id===c.id)?u.map(y=>y.id===c.id?c:y):[...u,c];return oe(p),p}),l(null)}function f(c){r(u=>{const p=u.filter(y=>y.id!==c);return oe(p),p})}return e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{type:"button",className:"px-3 py-2 rounded-xl border shadow-sm text-sm bg-white/80 dark:bg-slate-800 text-slate-800 dark:text-slate-100 hover:bg-white dark:hover:bg-slate-700",onClick:()=>o(c=>!c),"aria-haspopup":"menu","aria-expanded":a,children:"템플릿"}),a&&e.jsxs("div",{role:"menu",tabIndex:-1,className:"absolute z-20 mt-2 w-72 max-h-80 overflow-auto rounded-2xl border bg-white text-slate-900 dark:bg-slate-900 dark:text-slate-100 shadow-lg p-2",children:[e.jsx("div",{className:"px-2 py-1 text-xs text-slate-500 dark:text-slate-400",children:"기본 템플릿"}),ie.map(c=>e.jsx("button",{className:"w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>{t(ae(c.content)),o(!1)},children:c.name},c.id)),e.jsx("div",{className:"px-2 py-1 text-xs text-slate-500 dark:text-slate-400 mt-2",children:"내 템플릿"}),s.length===0&&e.jsx("div",{className:"px-3 py-2 text-xs text-slate-400 dark:text-slate-500",children:"아직 없어요. 아래에서 추가하세요."}),s.map(c=>e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1",children:[e.jsx("button",{className:"flex-1 text-left px-2 py-1 rounded hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>{t(ae(c.content)),o(!1)},children:c.name}),e.jsx("button",{className:"text-xs px-2 py-1 rounded hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>l(c),children:"수정"}),e.jsx("button",{className:"text-xs px-2 py-1 rounded hover:bg-red-50 dark:hover:bg-red-900/40 text-red-600",onClick:()=>f(c.id),children:"삭제"})]},c.id)),e.jsx("div",{className:"p-2",children:e.jsx("button",{className:"w-full text-center px-3 py-2 rounded-xl border hover:bg-slate-50 dark:hover:bg-slate-800",onClick:()=>l({id:crypto.randomUUID(),name:"",content:""}),children:"+ 새 템플릿 추가"})})]}),n&&e.jsx("div",{className:"fixed inset-0 z-30 flex items-center justify-center bg-black/60 p-4",onClick:()=>l(null),children:e.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 p-5 shadow-2xl",onClick:c=>c.stopPropagation(),children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:n.name?"템플릿 수정":"새 템플릿"}),e.jsx("label",{className:"block text-sm mb-1",children:"이름"}),e.jsx("input",{className:"w-full mb-3 px-3 py-2 rounded-xl border bg-white dark:bg-slate-900",value:n.name,onChange:c=>l(T(S({},n),{name:c.target.value})),placeholder:"예: 회의 템플릿 v2"}),e.jsxs("label",{className:"block text-sm mb-1",children:["내용"," ",e.jsxs("span",{className:"text-xs text-slate-500",children:["(변수: ",e.jsx("code",{children:"{{date}}"}),", ",e.jsx("code",{children:"{{time}}"}),")"]})]}),e.jsx("textarea",{className:"w-full h-56 mb-4 px-3 py-2 rounded-xl border font-mono text-sm bg-white dark:bg-slate-900",value:n.content,onChange:c=>l(T(S({},n),{content:c.target.value})),placeholder:"# 제목 — {{date}}"}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"미리보기는 삽입 시 적용돼요."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded-xl border hover:bg-slate-50 dark:hover:bg-slate-800",onClick:()=>l(null),children:"닫기"}),e.jsx("button",{className:"px-3 py-2 rounded-xl bg-blue-600 text-white disabled:opacity-50",disabled:!n.name||!n.content,onClick:()=>d(n),children:"저장"})]})]})]})})]})}const le={Productivity:"bg-blue-100 text-blue-800 border-blue-200",Learning:"bg-green-100 text-green-800 border-green-200",Mindset:"bg-purple-100 text-purple-800 border-purple-200",Health:"bg-pink-100 text-pink-800 border-pink-200",Fitness:"bg-orange-100 text-orange-800 border-orange-200",Finance:"bg-yellow-100 text-yellow-800 border-yellow-200",Career:"bg-indigo-100 text-indigo-800 border-indigo-200",Tech:"bg-gray-100 text-gray-800 border-gray-200",Relationships:"bg-red-100 text-red-800 border-red-200",Creativity:"bg-teal-100 text-teal-800 border-teal-200",Other:"bg-slate-100 text-slate-800 border-slate-200"};function Le({topic:t,variant:s="default",onClick:r}){const a="inline-flex items-center border font-medium rounded-full transition-all duration-200",o=s==="small"?"px-2 py-1 text-xs":"px-3 py-1 text-sm",n=le[t]||le.Other,l=s==="selected"?"ring-2 ring-blue-500 ring-opacity-50 transform scale-105":"",d=r?"cursor-pointer hover:scale-105 hover:shadow-sm":"";return e.jsx("span",{className:`${a} ${o} ${n} ${l} ${d}`,onClick:r,children:t})}function ce(t){let s="";return typeof t=="string"?s=t:t==null?s="":s=String(t),s?Rt(s).map(o=>{if(o.isCode)return o.text;let n=o.text;return n=n.replace(/\r\n?/g,`
`),n=n.replace(/[“”]/g,'"').replace(/[‘’]/g,"'"),n=n.replace(/[\u200B-\u200D\uFEFF]/g,""),n=n.replace(/[\u00A0]/g," "),n=n.split(`
`).map(l=>/^\s*[•·▪◦\-\*]\s+/u.test(l)?l.replace(/^\s*[•·▪◦\-\*]\s+/u,"- "):(l=l.replace(/^\s*(\d+)[\)\.-]\s+/,(f,c)=>`${c}. `),l)).join(`
`),n=n.replace(/\n{3,}/g,`

`),n=Lt(n),n=n.replace(/[ \t]+$/gm,""),n.trim()}).join(""):""}function Rt(t){const s=[],r=/```[\s\S]*?```/g;let a=0,o;for(;(o=r.exec(t))!==null;){const l=t.slice(a,o.index);l&&s.push({isCode:!1,text:l}),s.push({isCode:!0,text:o[0]}),a=r.lastIndex}const n=t.slice(a);return n&&s.push({isCode:!1,text:n}),s.length===0&&s.push({isCode:!1,text:t}),s}function Lt(t){const s=/(https?:\/\/[^\s)\]\}]+)([)\]\}]?)/g;return t.replace(s,(r,a,o)=>{try{const n=new URL(a);Array.from(n.searchParams.keys()).filter(f=>/^utm_|^fbclid$|^gclid$|^mc_eid$|^ref$|^ref_src$|^igshid$|^si$|^spm$|^yclid$|^pk_/.test(f)).forEach(f=>n.searchParams.delete(f)),n.search=n.searchParams.toString();let d=n.toString();return n.hash&&!d.includes(n.hash)&&(d+=n.hash),d+(o||"")}catch(n){return r}})}function Ot(){return w(this,null,function*(){try{const t=navigator;if(!(t!=null&&t.clipboard)||typeof t.clipboard.readText!="function")return{ok:!1,reason:"no_api"};const s=yield t.clipboard.readText();return typeof s!="string"?{ok:!1,reason:"empty"}:s.replace(/\r\n?/g,`
`).trim()?{ok:!0,text:s}:{ok:!1,reason:"empty"}}catch(t){const s=String((t==null?void 0:t.message)||t||"");return/denied|permission/i.test(s)?{ok:!1,reason:"denied",debug:s}:/secure|insecure|https|available/i.test(s)?{ok:!1,reason:"no_api",debug:s}:{ok:!1,reason:"unknown",debug:s}}})}const Pt=[{name:"회의",keywords:["회의","안건","의견","합의","미팅","회의록"]},{name:"독서",keywords:["독서","책","인용","장","문장","서평"]},{name:"아이디어",keywords:["아이디어","가설","실험","메모","브레인스토밍"]},{name:"건강",keywords:["운동","수면","식단","건강","헬스","스트레칭"]},{name:"학습",keywords:["학습","공부","강의","강좌","요약","노트"]}];function Dt(){const t=["topicRules","topic.rules","topic.rules.json"];for(const s of t)try{const r=localStorage.getItem(s);if(!r)continue;const a=JSON.parse(r);if(Array.isArray(a))return a.filter(o=>o&&typeof o.name=="string"&&Array.isArray(o.keywords))}catch(r){}return[]}function It(t,s=6){const r=[...Pt,...Dt()],a=String(t||"").toLowerCase(),o=new Map;for(const n of r){const l=Array.isArray(n.keywords)?n.keywords:[];for(const d of l){const f=String(d||"").toLowerCase();f&&a.includes(f)&&o.set(n.name,(o.get(n.name)||0)+f.length)}}return Array.from(o.entries()).sort((n,l)=>l[1]-n[1]).slice(0,s).map(([n])=>n)}function Ft(t){return t?typeof t.safeCreateNote=="function"?t.safeCreateNote:typeof t.default=="function"?t.default:typeof t=="function"?t:null:null}function Oe(t){return((t||"").split(/\n+/).map(r=>r.trim()).find(Boolean)||"메모").slice(0,80)}function $t(t){const s=Oe(t),r={content:t,title:s};return[t,{content:t},{text:t},{body:t},{raw:t},r,T(S({},r),{topics:[]}),T(S({},r),{favorite:!1}),{note:t,title:s}]}const Ut=["id","key","uuid","noteId","_id","pk","primaryKey"];function Bt(t){var s;if(t==null)return null;if(typeof t=="string"&&t.trim())return t.trim();if(typeof t=="number")return String(t);if(typeof t=="object"){const r=t;for(const a of Ut)if(r[a]!=null&&String(r[a]).trim())return String(r[a]).trim();if(r.ok&&(r.id||(s=r.data)!=null&&s.id))return String(r.id||r.data.id)}try{const r=String(t);return r.trim()?r.trim():null}catch(r){return null}}function de(t){const s=Oe(t),r=`local-${Date.now()}-${s.replace(/\s+/g,"-").toLowerCase().slice(0,24)||"note"}`;try{const a={id:r,content:t,title:s,createdAt:Date.now(),updatedAt:Date.now()};localStorage.setItem(`note:${r}`,JSON.stringify(a));const o=localStorage.getItem("note:index"),n=o?JSON.parse(o):[];n.unshift({id:r,title:s,createdAt:Date.now()}),localStorage.setItem("note:index",JSON.stringify(n.slice(0,500))),localStorage.setItem("note:lastSaved",r)}catch(a){}return r}function _t(t,s){return w(this,null,function*(){const r=typeof s=="string"?s:String(s!=null?s:""),a=Ft(t);if(!a)return de(r);for(const o of $t(r))try{const n=yield Promise.resolve(a(o)),l=Bt(n);if(l)return l}catch(n){}return de(r)})}const Mt="modulepreload",Jt=function(t){return"/"+t},ue={},xe=function(s,r,a){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(r.map(f=>{if(f=Jt(f),f in ue)return;ue[f]=!0;const c=f.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${u}`))return;const p=document.createElement("link");if(p.rel=c?"stylesheet":Mt,c||(p.as="script"),p.crossOrigin="",p.href=f,d&&p.setAttribute("nonce",d),document.head.appendChild(p),c)return new Promise((y,g)=>{p.addEventListener("load",y),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${f}`)))})}))}function n(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return o.then(l=>{for(const d of l||[])d.status==="rejected"&&n(d.reason);return s().catch(n)})};let $=null;const Kt=["safeCreateNote","createNote","saveNote","addNote","upsertNote","default"],Vt=S(S(S(S(S({},Object.assign({"./safeCreateNote.ts":()=>xe(()=>import("./safeCreateNote-BTgOMee0.js"),__vite__mapDeps([0,1,2,3,4]))})),Object.assign({"./safeCreateNote.ts":()=>xe(()=>import("./safeCreateNote-BTgOMee0.js"),__vite__mapDeps([0,1,2,3,4]))})),Object.assign({})),Object.assign({})),Object.assign({}));function Ht(){return w(this,null,function*(){if($)return $;const t=Object.entries(Vt);for(const[s,r]of t)try{const a=yield r();for(const o of Kt){const n=a==null?void 0:a[o];if(typeof n=="function")return $={mod:a,fn:n,name:`${s}#${o}`},$}}catch(a){}return null})}const Pe="data-robust-paste-bound";function he(t){var n;const s=t,r=((n=s.innerText)==null?void 0:n.trim())||"",a=s.getAttribute("aria-label")||"",o=s.title||"";return/붙여넣기|paste/i.test(r+" "+a+" "+o)}function me(t){t.setAttribute(Pe,"1")}function fe(t){return t.getAttribute(Pe)==="1"}function Wt(t){m.useEffect(()=>{const s=Array.from(document.querySelectorAll("button, [role='button']")).filter(he);if(s.length>0){const[a,...o]=s;o.forEach(n=>n.style.display="none"),fe(a)||(a.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),t()},{passive:!1}),me(a))}const r=new MutationObserver(()=>{const a=Array.from(document.querySelectorAll("button, [role='button']")).filter(he);if(a.length>0){const[o,...n]=a;n.forEach(l=>l.style.display="none"),fe(o)||(o.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),t()},{passive:!1}),me(o))}});return document.body&&r.observe(document.body,{childList:!0,subtree:!0}),()=>r.disconnect()},[t])}function qt(){const[t,s]=m.useState(""),[r,a]=m.useState(""),[o,n]=m.useState(""),[l,d]=m.useState([]),[f,c]=m.useState(()=>{const i=localStorage.getItem("smartPaste.enabled");return i?i==="1":!0}),u=m.useRef(null),p=m.useRef(!1),y=m.useCallback(()=>w(this,null,function*(){var i;try{const h=yield Ot();if(!h.ok){a(h.message||"클립보드에서 읽을 수 없어요.");return}const b=h.text||"",j=f?ce(b):b;s(N=>N?N+(N.endsWith(`
`)?"":`
`)+j:j),a("붙여넣기 완료"),(i=u.current)==null||i.focus(),g(j)}catch(h){a("붙여넣기에 실패했어요.")}}),[f]);Wt(y);function g(i){try{const h=(t?t+`
`:"")+i,b=It(h);d(b.slice(0,6))}catch(h){}}function x(){return w(this,null,function*(){if(p.current)return;const i=t.trim();if(!i){a("내용이 비어 있어요.");return}p.current=!0;try{const h=f?ce(i):i;a("저장 준비 중…");const b=yield Ht();if(!b){a("저장 실패: safeCreateNote를 찾을 수 없어요."),p.current=!1;return}n(b.name),a("저장 중…");const j=yield _t(b.mod,h);if(!j){a("저장 실패: 반환된 ID가 비어있어요."),p.current=!1;return}a("저장 완료"),window.location.assign(`/note/${encodeURIComponent(String(j))}`)}catch(h){console.error(h),a("저장 중 오류가 발생했어요.")}finally{p.current=!1}})}return e.jsxs("div",{className:"container-readable p-safe pb-24",children:[e.jsxs("header",{className:"flex items-center gap-2 justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"캡처"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(At,{onInsert:i=>{const b=(i||"").replaceAll("{{date}}",new Date().toISOString().slice(0,10)).replaceAll("{{time}}",new Date().toTimeString().slice(0,5));s(j=>j?j+`

`+b:b),g(b)}}),e.jsxs("label",{className:"text-xs flex items-center gap-2 px-3 py-2 rounded-xl card",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:i=>{const h=i.target.checked;c(h),localStorage.setItem("smartPaste.enabled",h?"1":"0")}}),"고급 클리닝"]})]})]}),r&&e.jsxs("div",{className:"banner mb-3",children:[r," ",o?e.jsxs("span",{className:"opacity-60",children:["(",o,")"]}):null]}),e.jsxs("section",{className:"card mb-3",children:[e.jsx("div",{className:"text-xs mb-2 opacity-70",children:"AI 주제 추천"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.length===0?e.jsx("span",{className:"text-xs text-gray-500",children:"내용을 입력하거나 붙여넣기 하면 추천이 보여요."}):l.map(i=>e.jsx(Le,{topic:i,variant:"small"},i))})]}),e.jsxs("section",{className:"card mb-3",children:[e.jsx("textarea",{ref:u,className:"input w-full min-h-[40vh]",placeholder:"여기에 붙여넣기 또는 직접 입력…",value:t,onChange:i=>{s(i.target.value),g(i.target.value)}}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx("button",{className:"btn btn-primary",onClick:x,children:"이 내용으로 저장"})})]}),e.jsxs("section",{className:"rounded-2xl border p-4 bg-white/70 dark:bg-gray-900/60",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"고급 클리닝은 이렇게 정리해요"}),e.jsxs("ul",{className:"text-sm leading-6 list-disc pl-5",children:[e.jsxs("li",{children:[e.jsx("b",{children:"코드블록"}),"(``` … ```)은 건드리지 않아요."]}),e.jsxs("li",{children:["글머리표는 제각각이면 ",e.jsx("code",{children:"-"})," 하나로 통일해요."]}),e.jsxs("li",{children:["번호목록은 ",e.jsx("code",{children:"1)"}),"/",e.jsx("code",{children:"1 -"}),"도 ",e.jsx("code",{children:"1."}),"로 맞춰요."]}),e.jsx("li",{children:"“스마트 따옴표”와 숨은 공백은 일반 문자로 바꿔요."}),e.jsxs("li",{children:["링크의 추적 꼬리표(",e.jsx("code",{children:"utm_"}),", ",e.jsx("code",{children:"gclid"})," 등)는 지워서 짧게 만들어요."]})]})]})]})}function zt(){const{id:t}=Ve(),s=je(),{toggleFavorite:r,updateNote:a,deleteNote:o}=z(),[n,l]=m.useState(null),[d,f]=m.useState(!0),[c,u]=m.useState(!1),[p,y]=m.useState(""),[g,x]=m.useState("");m.useEffect(()=>{if(!t)return;w(this,null,function*(){try{const E=yield k.notes.get(t);E?(l(E),y(E.content),x(E.title)):s("/")}catch(E){console.error("Error loading note:",E),s("/")}finally{f(!1)}})},[t,s]);const i=()=>w(this,null,function*(){!n||!t||(yield a(t,{title:g.trim(),content:p.trim()}),l(T(S({},n),{title:g.trim(),content:p.trim()})),u(!1))}),h=()=>{y((n==null?void 0:n.content)||""),x((n==null?void 0:n.title)||""),u(!1)},b=()=>w(this,null,function*(){t&&confirm("이 노트를 정말 삭제하시겠습니까?")&&(yield o(t),s("/"))}),j=v=>w(this,null,function*(){if(!n||!t)return;const E=[...n.todo];E[v]=T(S({},E[v]),{done:!E[v].done}),yield a(t,{todo:E}),l(T(S({},n),{todo:E}))}),N=v=>new Date(v).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=v=>{switch(v){case"youtube":return"🎬";case"book":return"📖";case"web":return"🌐";default:return"📝"}};return d?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"노트를 불러오는 중..."})]})}):n?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"sticky top-0 z-10 bg-gray-50/80 backdrop-blur-lg border-b border-gray-200/80",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(D,{to:"/",className:"p-2 text-gray-600 hover:bg-gray-200/70 rounded-lg transition-colors",children:e.jsx(ke,{className:"h-5 w-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"노트 상세"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>u(!c),className:"p-2 text-gray-600 hover:bg-gray-200/70 rounded-lg transition-colors",children:e.jsx(Xe,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>r(n.id),className:`p-2 rounded-lg transition-colors ${n.favorite?"text-red-500 hover:bg-red-100/50":"text-gray-400 hover:text-red-500 hover:bg-red-100/50"}`,children:n.favorite?e.jsx(re,{className:"h-5 w-5 fill-current"}):e.jsx(re,{className:"h-5 w-5"})}),e.jsx("button",{onClick:b,className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-100/50 rounded-lg transition-colors",children:e.jsx(U,{className:"h-5 w-5"})})]})]})})}),e.jsx("main",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 p-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{children:N(n.createdAt)})]}),n.sourceUrl&&e.jsxs("a",{href:n.sourceUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 hover:text-teal-600 transition-colors font-medium",children:[e.jsx(et,{className:"h-4 w-4"}),"원문 보기"]})]}),e.jsx("div",{className:"mb-6",children:c?e.jsx("input",{type:"text",value:g,onChange:v=>x(v.target.value),className:"w-full text-3xl font-bold text-gray-900 bg-white/60 border border-gray-300/50 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-colors"}):e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:[C(n.sourceType)," ",n.title]})}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-8",children:n.topics.map(v=>e.jsx(Le,{topic:v},v))}),e.jsx("div",{className:"mb-8",children:c?e.jsxs("div",{children:[e.jsx("textarea",{value:p,onChange:v=>y(v.target.value),rows:15,className:"w-full px-4 py-3 border border-gray-300/50 bg-white/60 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent resize-y transition-colors"}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsxs("button",{onClick:h,className:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300/50 bg-white/50 hover:bg-white/80 rounded-lg transition-colors text-sm",children:[e.jsx(Se,{className:"h-4 w-4"}),"취소"]}),e.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors text-sm font-semibold",children:[e.jsx(H,{className:"h-4 w-4"}),"저장"]})]})]}):e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap leading-relaxed",children:n.content})})}),n.highlights.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5 text-yellow-500"}),"하이라이트"]}),e.jsx("div",{className:"space-y-2",children:n.highlights.map((v,E)=>e.jsx("div",{className:"bg-yellow-100/50 border border-yellow-200/50 rounded-lg p-3",children:e.jsx("div",{className:"text-yellow-900/80",children:v.text})},E))})]}),n.todo.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:["✅ 할 일",e.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",n.todo.filter(v=>v.done).length,"/",n.todo.length," 완료)"]})]}),e.jsx("div",{className:"space-y-2",children:n.todo.map((v,E)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/60 rounded-lg",children:[e.jsx("button",{onClick:()=>j(E),className:`mt-1 w-4 h-4 rounded-sm border-2 flex-shrink-0 flex items-center justify-center transition-colors ${v.done?"bg-teal-500 border-teal-500 text-white":"border-gray-400/80 hover:border-teal-500"}`,children:v.done&&e.jsx(H,{className:"h-3 w-3"})}),e.jsx("span",{className:`flex-1 ${v.done?"line-through text-gray-500":"text-gray-800"}`,children:v.text})]},E))})]}),n.labels.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"라벨"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.labels.map(v=>e.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:["#",v]},v))})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"노트를 찾을 수 없습니다."}),e.jsx(D,{to:"/",className:"text-blue-600 hover:text-blue-700",children:"홈으로 돌아가기"})]})})}let A=null,L=[],ge=!1;function Gt(){ge||(ge=!0,window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),A=t,L.forEach(s=>s(!0))}),window.addEventListener("appinstalled",()=>{A=null,L.forEach(t=>t(!1))}))}function Yt(){return!!A}function Qt(){return w(this,null,function*(){if(!A)return!1;try{A.prompt();const{outcome:t}=yield A.userChoice;return A=null,L.forEach(s=>s(!1)),t==="accepted"}catch(t){return!1}})}function Xt(t){return L.push(t),()=>{L=L.filter(s=>s!==t)}}function De(t,s){return w(this,null,function*(){const r=new TextEncoder,a=yield crypto.subtle.importKey("raw",r.encode(t),{name:"PBKDF2"},!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:12e4,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])})}function M(t){return btoa(String.fromCharCode(...new Uint8Array(t)))}function J(t){const s=atob(t),r=new Uint8Array(s.length);for(let a=0;a<s.length;a++)r[a]=s.charCodeAt(a);return r}function Zt(t,s){return w(this,null,function*(){const r=new TextEncoder,a=crypto.getRandomValues(new Uint8Array(12)),o=crypto.getRandomValues(new Uint8Array(16)),n=yield De(s,o),l=r.encode(JSON.stringify(t)),d=yield crypto.subtle.encrypt({name:"AES-GCM",iv:a},n,l);return{v:1,alg:"AES-GCM",kdf:"PBKDF2-SHA256",iv:M(a),salt:M(o),data:M(d)}})}function es(t,s){return w(this,null,function*(){const r=J(t.iv),a=J(t.salt),o=yield De(s,a),n=J(t.data),l=yield crypto.subtle.decrypt({name:"AES-GCM",iv:r},o,n),d=new TextDecoder;return JSON.parse(d.decode(l))})}function Ie(){return w(this,null,function*(){const t=yield k.notes.toArray(),s=yield k.settings.toArray(),r={version:1,exportedAt:Date.now(),notes:t,settings:s};return new Blob([JSON.stringify(r,null,2)],{type:"application/json"})})}function ts(t){return w(this,null,function*(){const s=yield k.notes.toArray(),r=yield k.settings.toArray(),a={version:1,exportedAt:Date.now(),notes:s,settings:r},o=yield Zt(a,t);return new Blob([JSON.stringify(o)],{type:"application/json"})})}function ss(t){return w(this,null,function*(){const s=yield t.text(),r=JSON.parse(s);return Fe(r)})}function rs(t,s){return w(this,null,function*(){const r=yield t.text(),a=JSON.parse(r),o=yield es(a,s);return Fe(o)})}function Fe(t){return w(this,null,function*(){if(!t||t.version!==1)throw new Error("Unknown backup format");yield k.transaction("rw",k.notes,k.settings,()=>w(this,null,function*(){for(const r of t.notes||[])yield k.notes.put(r);for(const r of t.settings||[])yield k.settings.put(r)}));try{localStorage.setItem("lastBackupRestoreAt",String(Date.now()))}catch(r){}return(t.notes||[]).length})}function ns(){return w(this,null,function*(){try{const t=Number(localStorage.getItem("lastBackupAt")||"0"),s=1e3*60*60*24*7;if(Date.now()-t<s)return;const r=yield Ie(),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a;const n=new Date().toISOString().slice(0,10);o.download=`selfdev-notes-backup-${n}.json`,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(a),localStorage.setItem("lastBackupAt",String(Date.now()))}catch(t){console.warn("[autoBackup]",t)}})}function as(){const[t,s]=m.useState(""),[r,a]=m.useState(!1),o=m.useRef(null),n=t.trim()?"암호화":"일반";function l(){return w(this,null,function*(){try{a(!0);const c=t.trim()?yield ts(t):yield Ie(),u=t.trim()?"selfdev-notes-backup.enc.json":"selfdev-notes-backup.json";os(c,u)}finally{a(!1)}})}function d(c){return w(this,null,function*(){var y;const u=c.currentTarget,p=(y=u==null?void 0:u.files)==null?void 0:y[0];if(p)try{a(!0);const g=t.trim()?yield rs(p,t):yield ss(p);alert(`${g}개의 노트를 복원했습니다.`),o.current&&(o.current.value=""),location.reload()}catch(g){alert(`복원 실패: ${(g==null?void 0:g.message)||g}`)}finally{a(!1),o.current&&(o.current.value="")}})}function f(){var c;(c=o.current)==null||c.click()}return e.jsxs("div",{className:"p-6 bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"백업 & 복원"}),e.jsxs("div",{className:"text-xs text-gray-600/80",children:["암호 입력 시 ",e.jsx("b",{children:"암호화"}),"로 동작, 비우면 ",e.jsx("b",{children:"일반"}),"으로 동작합니다."]})]})]}),e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full border border-gray-200/80 bg-gray-200/70 text-gray-800",children:["현재 모드: ",e.jsx("b",{children:n})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{value:t,onChange:c=>s(c.target.value),placeholder:"암호(선택) — 입력하면 암호화",className:"flex-1 text-sm border border-gray-300/50 bg-white/50 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-colors",autoComplete:"new-password"})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:l,disabled:r,className:`inline-flex items-center justify-center gap-2 px-3 py-3 rounded-lg font-semibold transition-colors ${r?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-teal-600 text-white hover:bg-teal-700"}`,children:[e.jsx(st,{className:"h-4 w-4"}),"백업 다운로드"]}),e.jsxs("button",{onClick:f,disabled:r,className:`inline-flex items-center justify-center gap-2 px-3 py-3 rounded-lg border transition-colors ${r?"bg-gray-100 text-gray-400 cursor-not-allowed":"border-gray-300/50 bg-white/50 hover:bg-white/80"}`,children:[e.jsx(rt,{className:"h-4 w-4"}),"파일에서 복원"]})]}),e.jsx("input",{type:"file",accept:"application/json",className:"hidden",ref:o,onChange:d}),e.jsxs("div",{className:"flex items-start gap-3 text-xs text-gray-700/80",children:[e.jsx(nt,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:"암호화 백업은 AES‑GCM + PBKDF2로 보호됩니다. 암호를 잊으면 복원할 수 없습니다."}),e.jsx("div",{children:"일반 백업은 사람이 읽을 수 있으니 보관에 주의하세요."})]})]})]})}function os(t,s){const r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=s,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(r)}function K(t){return(t/1024/1024).toFixed(2)}function is(t,s){return s?Math.min(100,Math.round(t/s*100)):0}function ls(){const[t,s]=m.useState({usage:0,quota:0}),[r,a]=m.useState(0),[o,n]=m.useState({notes:0,settings:0});m.useEffect(()=>{w(this,null,function*(){var f,c;try{const u=(yield(c=(f=navigator.storage)==null?void 0:f.estimate)==null?void 0:c.call(f))||{};s({usage:u.usage||0,quota:u.quota||0})}catch(u){}try{const u=yield k.notes.toArray();n({notes:u.length,settings:yield k.settings.count()});const p=u.reduce((y,g)=>{var x;try{return y+new Blob([JSON.stringify(g)]).size}catch(i){return y+(((x=g==null?void 0:g.content)==null?void 0:x.length)||0)}},0);a(p)}catch(u){}})},[]);function l(){return w(this,null,function*(){const c=(yield k.notes.toArray()).filter(u=>!String((u==null?void 0:u.content)||"").trim());if(!c.length){alert("삭제할 빈 노트가 없습니다.");return}confirm(`빈 노트 ${c.length}개를 삭제할까요?`)&&(yield k.transaction("rw",k.notes,()=>w(this,null,function*(){for(const u of c)yield k.notes.delete(u.id)})),location.reload())})}const d=m.useMemo(()=>is(t.usage,t.quota),[t]);return e.jsxs("div",{className:"p-6 bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(at,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"font-medium",children:"데이터 사용량"})]}),e.jsx("div",{className:"w-full h-2.5 bg-gray-200/70 rounded-full",children:e.jsx("div",{className:"h-2.5 bg-teal-500 rounded-full",style:{width:`${d}%`}})}),e.jsxs("div",{className:"text-xs text-gray-600",children:["브라우저 저장소 사용량: ",e.jsxs("b",{children:[K(t.usage),"MB"]})," / ",K(t.quota),"MB (",d,"%)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-white/60",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"노트 개수"}),e.jsx("div",{className:"text-xl font-semibold",children:o.notes.toLocaleString()})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-white/60",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"노트 데이터"}),e.jsxs("div",{className:"text-xl font-semibold",children:[K(r),"MB"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx("div",{className:"text-xs text-gray-600/90",children:"빈 노트 정리로 약간의 공간을 확보할 수 있습니다."}),e.jsxs("button",{onClick:l,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-gray-300/50 bg-white/50 hover:bg-white/80 text-sm transition-colors",children:[e.jsx(U,{className:"h-4 w-4"})," 빈 노트 삭제"]})]})]})}const cs={Productivity:["todo","task","schedule","routine","workflow","focus","deep work","pomodoro","habit"],Learning:["study","learn","course","lecture","note-taking","flashcard"," spaced","anki","memory"],Mindset:["mindset","motivation","discipline","reflection","journal","grit","growth"],Health:["workout","fitness","sleep","diet","nutrition","meditation","yoga","steps"],Career:["career","job","interview","portfolio","resume","networking","leadership"]};function $e({children:t,onRemove:s}){return e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-full border border-gray-200 bg-gray-50",children:[t,s&&e.jsx("button",{className:"ml-1 rounded hover:bg-gray-200 px-1",onClick:s,"aria-label":"삭제",children:"×"})]})}function ds(){const[t,s]=m.useState({}),[r,a]=m.useState(""),[o,n]=m.useState(""),[l,d]=m.useState([]);m.useEffect(()=>{w(this,null,function*(){const i=yield k.settings.get("default");s(S({},(i==null?void 0:i.topicRules)||{}))})},[]);function f(){return w(this,null,function*(){const i=yield k.settings.get("default");yield k.settings.put(T(S({id:"default"},i||{}),{topicRules:t})),alert("규칙을 저장했어요.")})}function c(){const i=r.trim();!i||t[i]||(s(h=>T(S({},h),{[i]:[]})),a(""))}function u(i,h){const b=h.split(/[,;]/).map(j=>j.trim()).filter(Boolean);s(j=>{const N=new Set([...j[i]||[]]);return b.forEach(C=>N.add(C)),T(S({},j),{[i]:Array.from(N)})})}function p(i){const j=t,{[i]:h}=j,b=se(j,[te(i)]);s(b)}function y(i,h){s(b=>T(S({},b),{[i]:(b[i]||[]).filter(j=>j!==h)}))}function g(){confirm("기본 추천 규칙으로 되돌릴까요? 현재 규칙은 덮어써집니다.")&&s(S({},cs))}m.useEffect(()=>{const i=setTimeout(()=>w(this,null,function*(){if(!o.trim()){d([]);return}try{const h=yield q(o);d(h.slice(0,5))}catch(h){}}),200);return()=>clearTimeout(i)},[o]);const x=m.useMemo(()=>Object.keys(t).sort(),[t]);return e.jsxs("div",{className:"p-6 bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-lg",children:"토픽 규칙"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:g,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-gray-300/50 bg-white/50 hover:bg-white/80 text-sm transition-colors",children:[e.jsx(Ce,{className:"h-4 w-4"})," 기본값"]}),e.jsxs("button",{onClick:f,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-teal-600 text-white text-sm font-semibold hover:bg-teal-700 transition-colors",children:[e.jsx(ot,{className:"h-4 w-4"})," 저장"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:r,onChange:i=>a(i.target.value),placeholder:"새 토픽 이름(예: Research)",className:"flex-1 text-sm border border-gray-300/50 bg-white/50 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-colors"}),e.jsx("button",{onClick:c,className:"px-3 py-2 rounded-lg bg-teal-500 text-white hover:bg-teal-600 transition-colors",children:e.jsx(Ne,{className:"h-4 w-4"})})]}),x.length===0&&e.jsx("div",{className:"text-xs text-gray-500",children:"아직 사용자 정의 규칙이 없어요. 기본값을 불러오거나 새 토픽을 추가하세요."}),e.jsx("div",{className:"space-y-3",children:x.map(i=>e.jsxs("div",{className:"rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium",children:i}),e.jsxs("button",{onClick:()=>p(i),className:"text-red-600 text-xs inline-flex items-center gap-1",children:[e.jsx(U,{className:"h-3 w-3"})," 삭제"]})]}),e.jsx(us,{topic:i,values:t[i]||[],onAdd:h=>u(i,h),onRemove:h=>y(i,h)})]},i))}),e.jsxs("div",{className:"rounded-xl bg-white/60 border border-white/20 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(it,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"테스트"})]}),e.jsx("textarea",{value:o,onChange:i=>n(i.target.value),placeholder:"여기에 텍스트를 붙여넣으면 추론된 토픽을 미리봅니다.",className:"w-full min-h-[140px] border border-gray-300/50 bg-white/50 rounded-lg p-3 text-sm focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-colors"}),!!l.length&&e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(i=>e.jsx($e,{children:i},i))})]})]})}function us({topic:t,values:s,onAdd:r,onRemove:a}){const[o,n]=m.useState("");function l(){const d=o.trim();d&&(r(d),n(""))}return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(d=>e.jsx($e,{onRemove:()=>a(d),children:d},d))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:o,onChange:d=>n(d.target.value),placeholder:"키워드 추가(쉼표로 여러 개)",className:"flex-1 text-sm border border-gray-300/50 bg-white/50 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-colors"}),e.jsx("button",{onClick:l,className:"px-3 py-2 rounded-lg border border-gray-300/50 bg-white/50 hover:bg-white/80 text-sm transition-colors",children:"추가"})]})]})}const V={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function P({active:t,onClick:s,children:r}){return e.jsx("button",{onClick:s,className:`px-3 py-2 text-sm rounded-lg border ${t?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:r})}function xs(){const{notes:t}=z(),[s,r]=m.useState("general"),[a,o]=m.useState(Yt()),[n,l]=m.useState(null);m.useEffect(()=>Xt(o),[]),m.useEffect(()=>{w(this,null,function*(){const g=yield k.settings.get("default");l(g||null)})},[]),m.useEffect(()=>{ns()},[]);const d=t.length,f=m.useMemo(()=>{const g=new Set;return t.forEach(x=>(x.topics||[]).forEach(i=>g.add(i))),g.size},[t]);function c(){return w(this,null,function*(){if(!n)return;const g=n.theme==="dark"?"light":"dark",x=T(S({},n),{theme:g});yield k.settings.put(S({id:"default"},x)),l(x);try{const i=document.documentElement;g==="dark"?i.classList.add("dark"):i.classList.remove("dark"),localStorage.setItem("pref-theme",g)}catch(i){}})}function u(){return w(this,null,function*(){confirm("정말 모든 노트와 설정을 삭제할까요? 이 작업은 되돌릴 수 없습니다.")&&(indexedDB.deleteDatabase("selfdev-db"),location.reload())})}function p(){history.back()}function y(){location.assign("/")}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:p,className:"p-2 rounded-lg border bg-white/80 hover:bg-white transition-colors",title:"뒤로가기",children:e.jsx(ke,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"설정"}),e.jsx("p",{className:"text-sm text-gray-500",children:"백업/복원, 데이터, 분류 규칙, PWA 설치"})]})]}),e.jsxs("button",{onClick:y,className:"inline-flex items-center gap-2 text-sm px-4 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-100 text-gray-700 transition-colors",title:"홈으로",children:[e.jsx(lt,{className:"h-4 w-4"})," 홈으로"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(P,{active:s==="general",onClick:()=>r("general"),children:"일반"}),e.jsx(P,{active:s==="backup",onClick:()=>r("backup"),children:"백업"}),e.jsx(P,{active:s==="data",onClick:()=>r("data"),children:"데이터"}),e.jsx(P,{active:s==="topics",onClick:()=>r("topics"),children:"분류 규칙"}),e.jsx(P,{active:s==="app",onClick:()=>r("app"),children:"앱"})]}),s==="general"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("section",{className:"p-6 bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"테마"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["현재: ",(n==null?void 0:n.theme)||"light"]})]}),e.jsxs("button",{onClick:c,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border bg-white/80 hover:bg-white transition-colors",children:[(n==null?void 0:n.theme)==="dark"?e.jsx(ct,{className:"h-4 w-4"}):e.jsx(dt,{className:"h-4 w-4"}),(n==null?void 0:n.theme)==="dark"?"라이트로 전환":"다크로 전환"]})]})}),e.jsxs("section",{className:"p-4 bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-white/60",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"전체 노트"}),e.jsx("div",{className:"text-xl font-semibold",children:d.toLocaleString()})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/60",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"주제 수"}),e.jsx("div",{className:"text-xl font-semibold",children:f.toLocaleString()})]})]})]}),s==="backup"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(as,{}),e.jsx("div",{className:"text-xs text-gray-500",children:"자동 백업은 앱을 열었을 때 최근 백업이 7일 이상 지났다면 JSON을 다운로드합니다."})]}),s==="data"&&e.jsx("div",{className:"space-y-4",children:e.jsx(ls,{})}),s==="topics"&&e.jsx("div",{className:"space-y-4",children:e.jsx(ds,{})}),s==="app"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("section",{className:"p-6 bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ut,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"PWA 설치"}),e.jsx("div",{className:"text-xs text-gray-500",children:"홈화면에 앱처럼 설치합니다."})]})]}),e.jsx("button",{disabled:!a,onClick:Qt,className:`px-4 py-2 rounded-lg text-sm font-semibold transition-colors ${a?"bg-teal-600 text-white hover:bg-teal-700":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:"설치하기"})]})}),e.jsxs("section",{className:"p-6 bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"캐시 초기화"}),e.jsx("div",{className:"text-xs text-gray-500",children:"서비스워커/캐시 꼬임 시 강제 새로고침"})]})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>{var g;(g=navigator.serviceWorker)==null||g.getRegistrations().then(x=>x.forEach(i=>i.unregister())),location.reload()},className:"px-4 py-2 rounded-lg border bg-white/80 hover:bg-white text-sm transition-colors",children:"캐시 비우고 새로고침"})})]}),e.jsxs("section",{className:"p-6 bg-red-500/10 backdrop-blur-lg rounded-2xl shadow-lg border border-red-500/20",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-700",children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("div",{className:"font-medium",children:"위험 구역"})]}),e.jsx("p",{className:"text-xs text-red-700/80 mt-2",children:"모든 데이터를 완전히 삭제합니다. 백업 후 진행하세요."}),e.jsx("button",{onClick:u,className:"mt-3 px-4 py-2 rounded-lg border bg-white/80 hover:bg-white text-red-600 border-red-300/50 text-sm font-semibold transition-colors",children:"전체 삭제"})]}),e.jsx("section",{className:"text-xs text-gray-400 px-1",children:e.jsxs("div",{children:["버전: ",e.jsxs("code",{children:["v",window.BUILD_VERSION||(V==null?void 0:V.VITE_APP_VERSION)||"local"]})]})})]})]})}function pe(){const[t]=He(),s=je();return m.useEffect(()=>{const r=t.get("text"),a=t.get("url"),o=t.get("title");if(r||a||o){const n=new URLSearchParams;r&&n.set("text",r),a&&n.set("url",a),o&&n.set("title",o),s(`/capture?${n.toString()}`,{replace:!0})}},[t,s]),null}function hs(){return e.jsx(We,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(pe,{}),e.jsxs(qe,{children:[e.jsx(O,{path:"/",element:e.jsx(Ct,{})}),e.jsx(O,{path:"/capture",element:e.jsx(qt,{})}),e.jsx(O,{path:"/note/:id",element:e.jsx(zt,{})}),e.jsx(O,{path:"/settings",element:e.jsx(xs,{})}),e.jsx(O,{path:"/share",element:e.jsx(pe,{})})]})]})})}const R={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function ms(){const s=window.BUILD_VERSION,r=(R==null?void 0:R.VITE_APP_VERSION)||(R==null?void 0:R.VITE_COMMIT_SHA),a=new Date().toISOString().slice(0,10),o=(s||r||"").toString().trim();return o?o.length>16?o.slice(0,16):o:a}function fs(){const[t,s]=m.useState("");return m.useEffect(()=>{s(ms())},[]),e.jsx("div",{className:"fixed bottom-2 right-3 z-[9999]",children:e.jsxs("span",{className:"select-none text-[10px] px-2 py-1 rounded-full bg-black/70 text-white tracking-wider",children:["v",t||"local"]})})}function be(){const{pathname:t="/",hash:s=""}=window.location;if(s&&s.startsWith("#")){const r=s.slice(1);return r.startsWith("/")?r:`/${r}`}return t||"/"}(function(){if(window.__locationChangePatched)return;window.__locationChangePatched=!0;const s=history.pushState,r=history.replaceState;function a(){window.dispatchEvent(new Event("locationchange"))}history.pushState=function(...o){s.apply(this,o),a()},history.replaceState=function(...o){r.apply(this,o),a()},window.addEventListener("popstate",a),window.addEventListener("hashchange",a)})();function gs(){var r;const t=(r=crypto==null?void 0:crypto.randomUUID)==null?void 0:r.call(crypto);if(t)return t;const s=Math.random().toString(36).slice(2,8);return`n_${Date.now()}_${s}`}function ye(t){return w(this,null,function*(){const s=gs(),r=yield q(t),a=Ae(t),o=Date.now();return yield k.notes.put({id:s,content:t,topics:r,favorite:!1,createdAt:o,title:a,sourceType:"share",todo:[]}),s})}function ps(){const[t,s]=m.useState(be()),[r,a]=m.useState(!1),[o,n]=m.useState(null),[l,d]=m.useState(!1),[f,c]=m.useState(""),u=m.useRef(null);m.useEffect(()=>{const h=()=>s(be());return window.addEventListener("locationchange",h),window.addEventListener("hashchange",h),window.addEventListener("popstate",h),()=>{window.removeEventListener("locationchange",h),window.removeEventListener("hashchange",h),window.removeEventListener("popstate",h)}},[]);const p=t.toLowerCase().startsWith("/capture");m.useEffect(()=>{if(l){const h=setTimeout(()=>{var b;return(b=u.current)==null?void 0:b.focus()},50);return()=>clearTimeout(h)}},[l]),m.useEffect(()=>{p||(n(null),d(!1),c(""))},[p]);function y(h){h&&n(h),c(""),d(!0)}function g(h){return w(this,null,function*(){location.assign(h)})}function x(){return w(this,null,function*(){var h;if(p)try{a(!0);const b=!!((h=navigator.clipboard)!=null&&h.readText),j=window.isSecureContext!==!1;if(b&&j)try{const N=((yield navigator.clipboard.readText())||"").trim();if(console.debug("[ClipboardAgent] readText length=",N.length),N){const C=yield ye(N);n("저장 완료!"),setTimeout(()=>n(null),1e3),yield g(`/note/${C}`);return}else{y("클립보드가 비어 있어요. 직접 붙여넣기 해주세요.");return}}catch(N){console.warn("[ClipboardAgent] readText failed:",N);const C=((N==null?void 0:N.message)||N||"").toString().toLowerCase();if(C.includes("denied")||C.includes("allow")||C.includes("permission")||C.includes("notallowed")){y("클립보드 권한이 차단되어 있어요. 직접 붙여넣기 해주세요.");return}y("이 브라우저에서는 직접 붙여넣기가 필요해요.");return}else{y(j?"이 브라우저는 클립보드 API를 지원하지 않아요.":"HTTPS가 아니라서 읽을 수 없어요.");return}}finally{a(!1)}})}function i(){return w(this,null,function*(){const h=f.trim();if(!h){n("내용이 비어 있어요.");return}const b=yield ye(h);n("저장 완료!"),d(!1),c(""),setTimeout(()=>n(null),1e3),yield g(`/note/${b}`)})}return p?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:x,disabled:r,title:"클립보드 붙여넣기 → 자동 저장",className:`fixed bottom-16 right-3 z-[9998] inline-flex items-center gap-2 px-3 py-2 rounded-full shadow-md border
          ${r?"bg-gray-200 text-gray-500 border-gray-200":"bg-blue-600 text-white border-blue-600 hover:brightness-110"}`,children:[e.jsx(xt,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"붙여넣기"})]}),o&&e.jsx("div",{className:"fixed bottom-2 right-3 z-[9999]",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs px-3 py-2 rounded-lg shadow bg-black/80 text-white",children:[o.includes("완료")?e.jsx(H,{className:"h-3 w-3"}):e.jsx(ht,{className:"h-3 w-3"}),e.jsx("span",{children:o})]})}),l&&e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg bg-white rounded-xl shadow-lg border border-gray-100 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"클립보드에서 붙여넣기"}),e.jsx("button",{className:"p-1 rounded hover:bg-gray-100",onClick:()=>d(!1),"aria-label":"닫기",children:e.jsx(Se,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"자동 읽기가 제한되어 직접 붙여넣기가 필요합니다. (Windows: Ctrl+V, Mac: ⌘+V)"}),e.jsx("textarea",{ref:u,value:f,onChange:h=>c(h.target.value),placeholder:"여기에 붙여넣기…",className:"w-full min-h-[160px] border rounded-lg p-2 outline-none"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-3 py-2 text-sm rounded bg-gray-100",children:"취소"}),e.jsx("button",{onClick:i,className:"inline-flex items-center gap-2 px-3 py-2 text-sm rounded bg-blue-600 text-white",children:"저장"})]})]})})]}):null}function bs(){return e.jsxs(e.Fragment,{children:[e.jsx(hs,{}),e.jsx(fs,{}),e.jsx(ps,{})]})}Gt();const ys=document.getElementById("root");W.createRoot(ys).render(e.jsx(we.StrictMode,{children:e.jsx(wt,{children:e.jsx(bs,{})})}));export{q as a,k as d,Ae as g};
